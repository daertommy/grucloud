// Generated by 'gc gencode'
const {} = require("rubico");
const {} = require("rubico/x");

exports.createResources = () => [
  {
    type: "Classifier",
    group: "Glue",
    properties: ({}) => ({
      JsonClassifier: {
        JsonPath: "$.key",
        Name: "my-classifier",
      },
    }),
  },
  {
    type: "Crawler",
    group: "Glue",
    properties: ({}) => ({
      Name: "my-crawler",
      Targets: {
        S3Targets: [
          {
            Exclusions: [],
            Path: "s3://gc-glue-database",
          },
        ],
      },
    }),
    dependencies: ({}) => ({
      database: "my-database",
      iamRole: "AWSGlueServiceRole-my",
      s3Buckets: ["gc-glue-database"],
    }),
  },
  {
    type: "Database",
    group: "Glue",
    properties: ({}) => ({
      CreateTableDefaultPermissions: [
        {
          Permissions: ["ALL"],
          Principal: {
            DataLakePrincipalIdentifier: "IAM_ALLOWED_PRINCIPALS",
          },
        },
      ],
      Name: "my-database",
    }),
  },
  {
    type: "Table",
    group: "Glue",
    properties: ({ config }) => ({
      CatalogId: `${config.accountId()}`,
      Name: "my-table",
      Retention: 0,
      StorageDescriptor: {
        Columns: [],
        Compressed: false,
        InputFormat: "org.apache.hadoop.mapred.TextInputFormat",
        Location: "s3://gc-glue-database",
        NumberOfBuckets: 0,
        OutputFormat:
          "org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat",
        SerdeInfo: {
          SerializationLibrary: "org.openx.data.jsonserde.JsonSerDe",
        },
        SortColumns: [],
        StoredAsSubDirectories: false,
      },
    }),
    dependencies: ({}) => ({
      database: "my-database",
      s3Bucket: "gc-glue-database",
    }),
  },
  {
    type: "Policy",
    group: "IAM",
    properties: ({}) => ({
      PolicyName: "AWSGlueServiceRole-my-EZCRC-s3Policy",
      PolicyDocument: {
        Statement: [
          {
            Action: ["s3:GetObject", "s3:PutObject"],
            Effect: "Allow",
            Resource: ["arn:aws:s3:::gc-glue-database*"],
          },
        ],
        Version: "2012-10-17",
      },
      Path: "/service-role/",
      Description:
        "This policy will be used for Glue Crawler and Job execution. Please do NOT delete!",
    }),
  },
  {
    type: "Role",
    group: "IAM",
    properties: ({}) => ({
      RoleName: "AWSGlueServiceRole-my",
      Path: "/service-role/",
      AssumeRolePolicyDocument: {
        Version: "2012-10-17",
        Statement: [
          {
            Effect: "Allow",
            Principal: {
              Service: "glue.amazonaws.com",
            },
            Action: "sts:AssumeRole",
          },
        ],
      },
      AttachedPolicies: [
        {
          PolicyArn: "arn:aws:iam::aws:policy/service-role/AWSGlueServiceRole",
          PolicyName: "AWSGlueServiceRole",
        },
      ],
    }),
    dependencies: ({}) => ({
      policies: ["AWSGlueServiceRole-my-EZCRC-s3Policy"],
    }),
  },
  {
    type: "Bucket",
    group: "S3",
    properties: ({}) => ({
      Name: "gc-glue-database",
    }),
  },
];
