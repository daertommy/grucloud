// Generated by 'gc gencode'
const {} = require("rubico");
const {} = require("rubico/x");

exports.createResources = () => [
  {
    type: "ConfigurationRecorder",
    group: "Config",
    properties: ({ config }) => ({
      name: "default",
      recordingGroup: {
        allSupported: true,
        includeGlobalResourceTypes: false,
        resourceTypes: [],
      },
      roleARN: `arn:aws:iam::${config.accountId()}:role/aws-service-role/config.amazonaws.com/AWSServiceRoleForConfig`,
    }),
  },
  {
    type: "ConfigurationRecorderStatus",
    group: "Config",
    properties: ({}) => ({
      recording: true,
    }),
    dependencies: ({}) => ({
      deliveryChannel: "default",
    }),
  },
  {
    type: "ConformancePack",
    group: "Config",
    properties: ({}) => ({
      ConformancePackName: "pack-api-gateway",
      TemplateBody: `---
Description: "DO NOT MODIFY THIS STACK! This stack is managed by Config Conformance\\
  \ Packs."
Parameters:
  ApiGwEndpointTypeCheckParamEndpointConfigurationTypes:
    Type: "String"
    Default: "REGIONAL, PRIVATE, EDGE"
Mappings: {}
Conditions:
  apiGwEndpointTypeCheckParamEndpointConfigurationTypes:
    Fn::Not:
    - Fn::Equals:
      - ""
      - Ref: "ApiGwEndpointTypeCheckParamEndpointConfigurationTypes"
Rules: {}
Resources:
  ApiGwAssociatedWithWaf:
    Type: "AWS::Config::ConfigRule"
    Properties:
      ConfigRuleName: "api-gw-associated-with-waf-conformance-pack-xcb7t6kmi-conformance-pack-zm7lptinf"
      Scope:
        ComplianceResourceTypes:
        - "AWS::ApiGateway::Stage"
      Source:
        Owner: "AWS"
        SourceIdentifier: "API_GW_ASSOCIATED_WITH_WAF"
  ApiGwCacheEnabledAndEncrypted:
    Type: "AWS::Config::ConfigRule"
    Properties:
      ConfigRuleName: "api-gw-cache-enabled-and-encrypted-conformance-pack-xcb7t6kmi-conformance-pack-zm7lptinf"
      Scope:
        ComplianceResourceTypes:
        - "AWS::ApiGateway::Stage"
      Source:
        Owner: "AWS"
        SourceIdentifier: "API_GW_CACHE_ENABLED_AND_ENCRYPTED"
  ApiGwEndpointTypeCheck:
    Type: "AWS::Config::ConfigRule"
    Properties:
      ConfigRuleName: "api-gw-endpoint-type-check-conformance-pack-xcb7t6kmi-conformance-pack-zm7lptinf"
      InputParameters:
        endpointConfigurationTypes:
          Fn::If:
          - "apiGwEndpointTypeCheckParamEndpointConfigurationTypes"
          - Ref: "ApiGwEndpointTypeCheckParamEndpointConfigurationTypes"
          - Ref: "AWS::NoValue"
      Scope:
        ComplianceResourceTypes:
        - "AWS::ApiGateway::RestApi"
      Source:
        Owner: "AWS"
        SourceIdentifier: "API_GW_ENDPOINT_TYPE_CHECK"
  ApiGwExecutionLoggingEnabled:
    Type: "AWS::Config::ConfigRule"
    Properties:
      ConfigRuleName: "api-gw-execution-logging-enabled-conformance-pack-xcb7t6kmi-conformance-pack-zm7lptinf"
      Scope:
        ComplianceResourceTypes:
        - "AWS::ApiGateway::Stage"
        - "AWS::ApiGatewayV2::Stage"
      Source:
        Owner: "AWS"
        SourceIdentifier: "API_GW_EXECUTION_LOGGING_ENABLED"
  ApiGwSslEnabled:
    Type: "AWS::Config::ConfigRule"
    Properties:
      ConfigRuleName: "api-gw-ssl-enabled-conformance-pack-xcb7t6kmi-conformance-pack-zm7lptinf"
      Scope:
        ComplianceResourceTypes:
        - "AWS::ApiGateway::Stage"
      Source:
        Owner: "AWS"
        SourceIdentifier: "API_GW_SSL_ENABLED"
  ApiGwXrayEnabled:
    Type: "AWS::Config::ConfigRule"
    Properties:
      ConfigRuleName: "api-gw-xray-enabled-conformance-pack-xcb7t6kmi-conformance-pack-zm7lptinf"
      Scope:
        ComplianceResourceTypes:
        - "AWS::ApiGateway::Stage"
      Source:
        Owner: "AWS"
        SourceIdentifier: "API_GW_XRAY_ENABLED"
  CloudTrailCloudWatchLogsEnabled:
    Type: "AWS::Config::ConfigRule"
    Properties:
      ConfigRuleName: "cloud-trail-cloud-watch-logs-enabled-conformance-pack-xcb7t6kmi-conformance-pack-zm7lptinf"
      Source:
        Owner: "AWS"
        SourceIdentifier: "CLOUD_TRAIL_CLOUD_WATCH_LOGS_ENABLED"
  CloudTrailEnabled:
    Type: "AWS::Config::ConfigRule"
    Properties:
      ConfigRuleName: "cloudtrail-enabled-conformance-pack-xcb7t6kmi-conformance-pack-zm7lptinf"
      Source:
        Owner: "AWS"
        SourceIdentifier: "CLOUD_TRAIL_ENABLED"
Outputs: {}
AWSTemplateFormatVersion: "2010-09-09"
Hooks: {}
`,
      ConformancePackInputParameters: [],
    }),
  },
  {
    type: "DeliveryChannel",
    group: "Config",
    properties: ({}) => ({
      name: "default",
    }),
    dependencies: ({ config }) => ({
      configurationRecorder: "default",
      s3Bucket: `config-bucket-${config.accountId()}`,
    }),
  },
  {
    type: "Bucket",
    group: "S3",
    properties: ({ config }) => ({
      Name: `config-bucket-${config.accountId()}`,
      Policy: {
        Version: "2012-10-17",
        Statement: [
          {
            Sid: "AWSConfigBucketPermissionsCheck",
            Effect: "Allow",
            Principal: {
              Service: "config.amazonaws.com",
            },
            Action: "s3:GetBucketAcl",
            Resource: `arn:aws:s3:::config-bucket-${config.accountId()}`,
            Condition: {
              StringEquals: {
                "AWS:SourceAccount": `${config.accountId()}`,
              },
            },
          },
          {
            Sid: "AWSConfigBucketExistenceCheck",
            Effect: "Allow",
            Principal: {
              Service: "config.amazonaws.com",
            },
            Action: "s3:ListBucket",
            Resource: `arn:aws:s3:::config-bucket-${config.accountId()}`,
            Condition: {
              StringEquals: {
                "AWS:SourceAccount": `${config.accountId()}`,
              },
            },
          },
          {
            Sid: "AWSConfigBucketDelivery",
            Effect: "Allow",
            Principal: {
              Service: "config.amazonaws.com",
            },
            Action: "s3:PutObject",
            Resource: `arn:aws:s3:::config-bucket-${config.accountId()}/AWSLogs/${config.accountId()}/Config/*`,
            Condition: {
              StringEquals: {
                "AWS:SourceAccount": `${config.accountId()}`,
                "s3:x-amz-acl": "bucket-owner-full-control",
              },
            },
          },
        ],
      },
    }),
  },
];
