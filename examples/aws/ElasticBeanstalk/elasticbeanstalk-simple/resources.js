// Generated by 'gc gencode'
const {} = require("rubico");
const {} = require("rubico/x");

exports.createResources = () => [
  {
    type: "Application",
    group: "ElasticBeanstalk",
    properties: ({}) => ({
      ApplicationName: "my-app",
      ConfigurationTemplates: [],
    }),
  },
  {
    type: "ApplicationVersion",
    group: "ElasticBeanstalk",
    properties: ({}) => ({
      ApplicationName: "my-app",
      VersionLabel: "Sample Application",
      SourceBundle: {
        S3Bucket: "elasticbeanstalk-us-east-1",
        S3Key: "GenericSampleApplication",
      },
    }),
    dependencies: ({}) => ({
      application: "my-app",
    }),
  },
  {
    type: "Environment",
    group: "ElasticBeanstalk",
    properties: ({}) => ({
      EnvironmentName: "Myapp-env",
      VersionLabel: "Sample Application",
      SolutionStackName: "64bit Amazon Linux 2 v5.6.0 running Node.js 16",
      Tier: {
        Name: "WebServer",
        Type: "Standard",
        Version: "1.0",
      },
      EnvironmentLinks: [],
    }),
    dependencies: ({}) => ({
      application: "my-app",
    }),
  },
  {
    type: "Role",
    group: "IAM",
    properties: ({}) => ({
      RoleName: "aws-elasticbeanstalk-ec2-role",
      AssumeRolePolicyDocument: {
        Version: "2008-10-17",
        Statement: [
          {
            Effect: "Allow",
            Principal: {
              Service: "ec2.amazonaws.com",
            },
            Action: "sts:AssumeRole",
          },
        ],
      },
      AttachedPolicies: [
        {
          PolicyName: "AWSElasticBeanstalkMulticontainerDocker",
          PolicyArn:
            "arn:aws:iam::aws:policy/AWSElasticBeanstalkMulticontainerDocker",
        },
        {
          PolicyName: "AWSElasticBeanstalkWebTier",
          PolicyArn: "arn:aws:iam::aws:policy/AWSElasticBeanstalkWebTier",
        },
        {
          PolicyName: "AWSElasticBeanstalkWorkerTier",
          PolicyArn: "arn:aws:iam::aws:policy/AWSElasticBeanstalkWorkerTier",
        },
      ],
    }),
  },
  {
    type: "Role",
    group: "IAM",
    properties: ({}) => ({
      RoleName: "aws-elasticbeanstalk-service-role",
      AssumeRolePolicyDocument: {
        Version: "2012-10-17",
        Statement: [
          {
            Effect: "Allow",
            Principal: {
              Service: "elasticbeanstalk.amazonaws.com",
            },
            Action: "sts:AssumeRole",
            Condition: {
              StringEquals: {
                "sts:ExternalId": "elasticbeanstalk",
              },
            },
          },
        ],
      },
      AttachedPolicies: [
        {
          PolicyName: "AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy",
          PolicyArn:
            "arn:aws:iam::aws:policy/AWSElasticBeanstalkManagedUpdatesCustomerRolePolicy",
        },
        {
          PolicyName: "AWSElasticBeanstalkEnhancedHealth",
          PolicyArn:
            "arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth",
        },
      ],
    }),
  },
  {
    type: "InstanceProfile",
    group: "IAM",
    name: "aws-elasticbeanstalk-ec2-role",
    dependencies: ({}) => ({
      roles: ["aws-elasticbeanstalk-ec2-role"],
    }),
  },
  {
    type: "Bucket",
    group: "S3",
    properties: ({ config }) => ({
      Name: `elasticbeanstalk-${config.region}-${config.accountId()}`,
      Policy: {
        Version: "2008-10-17",
        Statement: [
          {
            Sid: "eb-58950a8c-feb6-11e2-89e0-0800277d041b",
            Effect: "Deny",
            Principal: {
              AWS: "*",
            },
            Action: "s3:DeleteBucket",
            Resource: `arn:aws:s3:::elasticbeanstalk-${
              config.region
            }-${config.accountId()}`,
          },
          {
            Sid: "eb-ad78f54a-f239-4c90-adda-49e5f56cb51e",
            Effect: "Allow",
            Principal: {
              AWS: `arn:aws:iam::${config.accountId()}:role/aws-elasticbeanstalk-ec2-role`,
            },
            Action: "s3:PutObject",
            Resource: `arn:aws:s3:::elasticbeanstalk-${
              config.region
            }-${config.accountId()}/resources/environments/logs/*`,
          },
          {
            Sid: "eb-af163bf3-d27b-4712-b795-d1e33e331ca4",
            Effect: "Allow",
            Principal: {
              AWS: `arn:aws:iam::${config.accountId()}:role/aws-elasticbeanstalk-ec2-role`,
            },
            Action: [
              "s3:ListBucket",
              "s3:ListBucketVersions",
              "s3:GetObject",
              "s3:GetObjectVersion",
            ],
            Resource: [
              `arn:aws:s3:::elasticbeanstalk-${
                config.region
              }-${config.accountId()}`,
              `arn:aws:s3:::elasticbeanstalk-${
                config.region
              }-${config.accountId()}/resources/environments/*`,
            ],
          },
        ],
      },
    }),
  },
];
