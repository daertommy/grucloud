// Generated by aws2gc
const { AwsProvider } = require("@grucloud/provider-aws");

const createResources = ({ provider }) => {
  provider.S3.makeBucket({
    name: "grucloud-acceleration",
    properties: ({ config }) => ({
      AccelerateConfiguration: {
        Status: "Enabled",
      },
    }),
  });

  provider.S3.makeBucket({
    name: "grucloud-cors",
    properties: ({ config }) => ({
      CORSConfiguration: {
        CORSRules: [
          {
            AllowedHeaders: ["Authorization"],
            AllowedMethods: ["GET"],
            AllowedOrigins: ["*"],
            ExposeHeaders: [],
            MaxAgeSeconds: 3000,
          },
        ],
      },
    }),
  });

  provider.S3.makeBucket({
    name: "grucloud-encryption",
    properties: ({ config }) => ({
      ServerSideEncryptionConfiguration: {
        Rules: [
          {
            ApplyServerSideEncryptionByDefault: {
              SSEAlgorithm: "AES256",
            },
            BucketKeyEnabled: false,
          },
        ],
      },
    }),
  });

  provider.S3.makeBucket({
    name: "grucloud-lifecycleconfiguration",
    properties: ({ config }) => ({
      LifecycleConfiguration: {
        Rules: [
          {
            Expiration: {
              Days: 3650,
            },
            ID: "TestOnly",
            Filter: {
              Prefix: "documents/",
            },
            Status: "Enabled",
            Transitions: [
              {
                Days: 365,
                StorageClass: "GLACIER",
              },
            ],
            NoncurrentVersionTransitions: [],
          },
        ],
      },
    }),
  });

  provider.S3.makeBucket({
    name: "grucloud-log-destination",
  });

  provider.S3.makeBucket({
    name: "grucloud-policy",
    properties: ({ config }) => ({
      Policy: {
        Version: "2012-10-17",
        Statement: [
          {
            Sid: "IPAllow",
            Effect: "Deny",
            Principal: "*",
            Action: "s3:*",
            Resource: "arn:aws:s3:::grucloud-policy/*",
            Condition: {
              IpAddress: {
                "aws:SourceIp": "8.8.8.8/32",
              },
            },
          },
        ],
      },
    }),
  });

  provider.S3.makeBucket({
    name: "grucloud-request-payment",
    properties: ({ config }) => ({
      RequestPaymentConfiguration: {
        Payer: "Requester",
      },
    }),
  });

  provider.S3.makeBucket({
    name: "grucloud-tag",
    properties: ({ config }) => ({
      Tags: [
        {
          Key: "Key1",
          Value: "Value1",
        },
        {
          Key: "Key2",
          Value: "Value2",
        },
      ],
    }),
  });

  provider.S3.makeBucket({
    name: "grucloud-test-basic",
  });

  provider.S3.makeBucket({
    name: "grucloud-versioning",
    properties: ({ config }) => ({
      VersioningConfiguration: {
        Status: "Enabled",
        MFADelete: "Disabled",
      },
    }),
  });

  provider.S3.makeBucket({
    name: "grucloud-website",
    properties: ({ config }) => ({
      ACL: "public-read",
      WebsiteConfiguration: {
        IndexDocument: {
          Suffix: "index.html",
        },
        ErrorDocument: {
          Key: "error.html",
        },
      },
    }),
  });

  provider.S3.makeObject({
    name: "file-test",
    properties: ({ config }) => ({
      ContentType: "text/plain",
      source: "s3/grucloud-test-basic/file-test.txt",
      Tags: [
        {
          Key: "Key1",
          Value: "Value1",
        },
        {
          Key: "Key2",
          Value: "Value2",
        },
      ],
    }),
    dependencies: ({ resources }) => ({
      bucket: resources.S3.Bucket.grucloudTestBasic,
    }),
  });
};

exports.createResources = createResources;

exports.createStack = async ({ createProvider }) => {
  const provider = createProvider(AwsProvider, { config: require("./config") });
  createResources({
    provider,
  });

  return {
    provider,
  };
};
