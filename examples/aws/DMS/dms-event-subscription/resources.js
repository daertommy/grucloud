// Generated by 'gc gencode'
const {} = require("rubico");
const {} = require("rubico/x");

exports.createResources = () => [
  {
    type: "EventSubscription",
    group: "DMS",
    properties: ({}) => ({
      SubscriptionName: "subscription-prod",
      Enabled: true,
      SourceType: "replication-instance",
    }),
    dependencies: ({}) => ({
      snsTopic: "dms-topic",
    }),
  },
  {
    type: "Topic",
    group: "SNS",
    name: "dms-topic",
    properties: ({ config }) => ({
      Attributes: {
        Policy: {
          Version: "2012-10-17",
          Id: "__default_policy_ID",
          Statement: [
            {
              Sid: "__default_statement_ID",
              Effect: "Allow",
              Principal: {
                AWS: "*",
              },
              Action: [
                "SNS:GetTopicAttributes",
                "SNS:SetTopicAttributes",
                "SNS:AddPermission",
                "SNS:RemovePermission",
                "SNS:DeleteTopic",
                "SNS:Subscribe",
                "SNS:ListSubscriptionsByTopic",
                "SNS:Publish",
              ],
              Resource: `arn:aws:sns:${
                config.region
              }:${config.accountId()}:dms-topic`,
              Condition: {
                StringEquals: {
                  "AWS:SourceOwner": `${config.accountId()}`,
                },
              },
            },
            {
              Sid: "dms-allow-publish",
              Effect: "Allow",
              Principal: {
                Service: "dms.amazonaws.com",
              },
              Action: "sns:Publish",
              Resource: `arn:aws:sns:${
                config.region
              }:${config.accountId()}:dms-topic`,
            },
          ],
        },
      },
    }),
  },
];
