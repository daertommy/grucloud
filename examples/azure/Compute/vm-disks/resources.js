// Generated by 'gc gencode'
const {} = require("rubico");
const {} = require("rubico/x");

exports.createResources = () => [
  {
    type: "Disk",
    group: "Compute",
    properties: ({ config }) => ({
      name: "vm_datadisk_0",
      location: config.location,
      sku: {
        name: "Premium_LRS",
      },
      properties: {
        hyperVGeneration: "V1",
        creationData: {
          createOption: "Empty",
        },
        diskSizeGB: 1,
        diskIOPSReadWrite: 120,
        diskMBpsReadWrite: 25,
        encryption: {
          type: "EncryptionAtRestWithPlatformKey",
        },
        networkAccessPolicy: "AllowAll",
        tier: "P1",
        publicNetworkAccess: "Enabled",
      },
    }),
    dependencies: ({}) => ({
      resourceGroup: "rg-vm-disks",
    }),
  },
  {
    type: "SshPublicKey",
    group: "Compute",
    properties: ({ config }) => ({
      name: "keypair",
      location: config.location,
      properties: {
        publicKey:
          "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDZw1HXdWqcJ7cGlPjbzskKEzS6rKsRAlqPCUqvtg89Ku/FDQS6ERuCaOq61PonN/aYgP2Zf6N/YlF7PfczoLIxpgDcOcayn9LiUglFxMdizxffoX74EROqDO4aXRgohrDzK0Qn/09aahCmV+5HGUfE7XHjj/KPyQsW96JCLJBy8sN4I+oK+6qeGL5jpI5smKS9sY2f3rMtMnIf9+TxwR0ccxb+PR2Vtjut0TvR/kpcYf13aDK6fCfE6BpQ2bJDbjVW5IR6czHtSMaOGSxi8Tasuf0nsyAFwUQR0q+CBC5GMMtslBakxy51fpK6BmvvDf7Bsrzh+IU63azE595kmaWyjpbzK3OkwbRrEVmFu6YC2PwPKlP6fMqDwW3pyrM7Saisuqe6ulRmKNgLZJiPcVMe2wm0YP7KlPIj/BzS68HpHYaPLf7BrWx5DMpGogxQO4MUYdNmY9FE1tfGqphMLWX6Gsp6uNfMhTtA0U4MuuzmMGk5XOxJUmD6gXy+ugsZToE= generated-by-azure",
      },
    }),
    dependencies: ({}) => ({
      resourceGroup: "rg-vm-disks",
    }),
  },
  {
    type: "VirtualMachine",
    group: "Compute",
    properties: ({ getId }) => ({
      name: "vm",
      properties: {
        hardwareProfile: {
          vmSize: "Standard_B1ls",
        },
        osProfile: {
          computerName: "vm",
          adminUsername: "ops",
          linuxConfiguration: {
            disablePasswordAuthentication: true,
            ssh: {
              publicKeys: [
                {
                  path: "/home/ops/.ssh/authorized_keys",
                  keyData: `${getId({
                    type: "SshPublicKey",
                    group: "Compute",
                    name: "rg-vm-disks::keypair",
                    path: "live.properties.publicKey",
                  })}`,
                },
              ],
            },
            enableVMAgentPlatformUpdates: false,
          },
          adminPassword: process.env.RG_VM_DISKS_VM_ADMIN_PASSWORD,
        },
        storageProfile: {
          imageReference: {
            publisher: "Canonical",
            offer: "UbuntuServer",
            sku: "18.04-LTS",
            version: "latest",
          },
          osDisk: {
            osType: "Linux",
            name: "vm_OsDisk_1_14336463e96443259dd32786de92d6e0",
            createOption: "FromImage",
            caching: "ReadWrite",
            managedDisk: {
              storageAccountType: "Premium_LRS",
            },
            deleteOption: "Detach",
            diskSizeGB: 30,
          },
          dataDisks: [
            {
              lun: 0,
              name: "vm_datadisk_0",
              createOption: "Attach",
              caching: "None",
              managedDisk: {
                storageAccountType: "Premium_LRS",
                id: getId({
                  type: "Disk",
                  group: "Compute",
                  name: "rg-vm-disks::vm_datadisk_0",
                }),
              },
              deleteOption: "Detach",
              diskSizeGB: 1,
              toBeDetached: false,
            },
          ],
        },
        networkProfile: {
          networkInterfaces: [
            {
              id: getId({
                type: "NetworkInterface",
                group: "Network",
                name: "rg-vm-disks::network-interface",
              }),
              properties: {
                primary: true,
              },
            },
          ],
        },
      },
    }),
    dependencies: ({}) => ({
      resourceGroup: "rg-vm-disks",
      disks: ["rg-vm-disks::vm_datadisk_0"],
      sshPublicKeys: ["rg-vm-disks::keypair"],
      networkInterfaces: ["rg-vm-disks::network-interface"],
    }),
  },
  {
    type: "NetworkInterface",
    group: "Network",
    properties: ({ config, getId }) => ({
      name: "network-interface",
      location: config.location,
      properties: {
        ipConfigurations: [
          {
            properties: {
              publicIPAddress: {
                id: `${getId({
                  type: "PublicIPAddress",
                  group: "Network",
                  name: "rg-vm-disks::ip-address",
                })}`,
              },
              subnet: {
                id: `${getId({
                  type: "Subnet",
                  group: "Network",
                  name: "rg-vm-disks::virtual-network::subnet",
                })}`,
              },
            },
            name: "ipconfig1",
          },
        ],
        enableIPForwarding: true,
      },
    }),
    dependencies: ({}) => ({
      resourceGroup: "rg-vm-disks",
      networkSecurityGroup: "rg-vm-disks::security-group",
      publicIpAddresses: ["rg-vm-disks::ip-address"],
      subnets: ["rg-vm-disks::virtual-network::subnet"],
    }),
  },
  {
    type: "NetworkSecurityGroup",
    group: "Network",
    properties: ({}) => ({
      name: "security-group",
      properties: {
        securityRules: [
          {
            name: "SSH",
            properties: {
              description: "allow SSH",
              protocol: "Tcp",
              sourcePortRange: "*",
              destinationPortRange: "22",
              sourceAddressPrefix: "*",
              destinationAddressPrefix: "*",
              access: "Allow",
              priority: 1000,
              direction: "Inbound",
              sourcePortRanges: [],
              destinationPortRanges: [],
              sourceAddressPrefixes: [],
              destinationAddressPrefixes: [],
            },
          },
        ],
      },
    }),
    dependencies: ({}) => ({
      resourceGroup: "rg-vm-disks",
    }),
  },
  {
    type: "PublicIPAddress",
    group: "Network",
    properties: ({}) => ({
      name: "ip-address",
    }),
    dependencies: ({}) => ({
      resourceGroup: "rg-vm-disks",
    }),
  },
  {
    type: "Subnet",
    group: "Network",
    properties: ({}) => ({
      name: "subnet",
      properties: {
        addressPrefix: "10.0.0.0/24",
      },
    }),
    dependencies: ({}) => ({
      resourceGroup: "rg-vm-disks",
      virtualNetwork: "rg-vm-disks::virtual-network",
    }),
  },
  {
    type: "VirtualNetwork",
    group: "Network",
    properties: ({}) => ({
      name: "virtual-network",
      properties: {
        addressSpace: {
          addressPrefixes: ["10.0.0.0/16"],
        },
      },
    }),
    dependencies: ({}) => ({
      resourceGroup: "rg-vm-disks",
    }),
  },
  {
    type: "ResourceGroup",
    group: "Resources",
    properties: ({}) => ({
      name: "rg-vm-disks",
    }),
  },
];
