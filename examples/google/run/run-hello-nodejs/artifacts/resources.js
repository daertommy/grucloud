// Generated by 'gc gencode'
const {} = require("rubico");
const {} = require("rubico/x");

exports.createResources = () => [
  {
    type: "Service",
    group: "run",
    properties: ({ config }) => ({
      apiVersion: "serving.knative.dev/v1",
      kind: "Service",
      metadata: {
        name: "starhackit-server",
      },
      spec: {
        template: {
          metadata: {
            name: "starhackit-server-00005-rud",
            annotations: {
              "autoscaling.knative.dev/maxScale": "100",
            },
          },
          spec: {
            containerConcurrency: 80,
            timeoutSeconds: 300,
            serviceAccountName: `${config.projectNumber()}-compute@developer.gserviceaccount.com`,
            containers: [
              {
                image: "gcr.io/google-samples/hello-app:1.0",
                resources: {
                  limits: {
                    cpu: "2000m",
                    memory: "512Mi",
                  },
                },
                ports: [
                  {
                    name: "http1",
                    containerPort: 8080,
                  },
                ],
              },
            ],
          },
        },
        traffic: [
          {
            percent: 100,
            latestRevision: true,
          },
        ],
      },
    }),
  },
  {
    type: "ServiceIamMember",
    group: "run",
    properties: ({ config }) => ({
      location: config.region,
      policy: {
        version: 1,
        bindings: [
          {
            role: "roles/run.invoker",
            members: ["allUsers"],
          },
        ],
      },
    }),
    dependencies: () => ({
      service: "starhackit-server",
    }),
  },
];
